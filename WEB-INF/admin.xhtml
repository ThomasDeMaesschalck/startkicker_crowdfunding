<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Startkicker - Admin</title>
    <h:outputStylesheet name="css/primeflex.css" />
    <h:outputStylesheet library="css" name="style.css" />
</h:head>
<h:body>
    <h:panelGrid rendered="#{loggedInUser.admin == true}">

<h1>Admin menu</h1>

       Hello admin
        <h:outputText value="#{loggedInUser.firstName}"></h:outputText>


    <br></br><br></br>

    <p:card>
        <br></br>


        <p:messages id="messages" showDetail="true" closable="true">
            <p:autoUpdate/>
        </p:messages>


        <p:commandButton icon="pi pi-user-plus" value="Add a new user" update=":userCreateForm:userCreate" oncomplete="PF('makeDialog').show()">
            <f:setPropertyActionListener value="#{user}" target="#{userBean.userToSave}"/>
        </p:commandButton>

        <br /><br />
        <h1>User list:</h1>
        <h:form id="userForm">
            <p:dataTable id="userlist" value = "#{myAppWideBean.allUsers}" var = "user"
                         rows="10"
                         paginator="true"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                         rowsPerPageTemplate="5,10,{ShowAll|'All'}" >

                <p:column headerText="Id" >
                    <h:outputText value="#{user.id}"   />
                </p:column>

                <p:column headerText="Name" >
                    <h:outputText value="#{user.name}"   />
                </p:column>

                <p:column headerText="Firstname">
                    <h:outputText value="#{user.firstName}" />
                </p:column>

                <p:column headerText="E-mail">
                    <h:outputText value="#{user.email}" />

                </p:column>

                <p:column headerText="Active?">
                    <h:outputText rendered="#{user.actif == true}"  styleClass="pi pi-check"/>
                    <p:commandButton rendered="#{user.actif == false}" action="#{userBean.activateUser(user.id)}"
                                     value="Activate #{user.id}"
                    update="userlist" />
                </p:column>

                <p:column headerText="Edit">
                <p:commandButton icon="fa fa-pencil" update=":userForm:userEdit" oncomplete="PF('editDialog').show()">
                    <f:setPropertyActionListener value="#{user}" target="#{userBean.selectedUser}"/>
                </p:commandButton>

                    <p:commandButton action="#{userBean.deleteUser(user)}"
                                     icon="fa fa-trash"
                                     update="userlist"
                                     styleClass="ui-button-danger"/>
                </p:column>
            </p:dataTable>

            <p:dialog header="Edit User" widgetVar="editDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="userEdit" style="text-align:center;">

                    <p:messages id="messages" showDetail="true" closable="true">
                        <p:autoUpdate/>
                    </p:messages>

                    <p:panelGrid  columns="2" rendered="#{not empty userBean.selectedUser}" columnClasses="label,value">
                        <h:outputText value="id #{userBean.selectedUser.id}" type="hidden"/>
                        <p:inputNumber value="#{userBean.selectedUser.id}" type="hidden" />
                        <h:outputText value="Name: " />
                        <p:inputText value="#{userBean.selectedUser.name}" />
                        <h:outputText value="Firstname: " />
                        <p:inputText value="#{userBean.selectedUser.firstName}" />
                        <h:outputText value="Username: " />
                        <p:inputText value="#{userBean.selectedUser.userName}" />
                        <h:outputText value="Password: " />
                        <p:inputText value="#{userBean.selectedUser.password}"/>
                        <h:outputText value="E-mail " />
                        <p:inputText value="#{userBean.selectedUser.email}" />

                        <h:outputText for="ActiveEdit" value="Active" />
                        <p:selectBooleanCheckbox id="ActiveEdit" value="#{userBean.selectedUser.actif}" itemLabel="Activate"/>

                        <h:outputText for="AdminEdit" value="Admin" />
                        <p:selectBooleanCheckbox id="AdminEdit" value="#{userBean.selectedUser.admin}" itemLabel="Administrator"/>

                    </p:panelGrid>
                    <p:commandButton value="Update" icon="fa fa-fw fa-pencil" action="#{userBean.userEdit}"/>
                </p:outputPanel>
            </p:dialog>
        </h:form>
    </p:card>



            <h:form id="userCreateForm">
                <p:dialog header="Make User" widgetVar="makeDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                    <p:outputPanel id="userCreate" style="text-align:center;">

                        <p:messages id="messages" showDetail="false" closable="true">
                            <p:autoUpdate/>
                        </p:messages>

                        <p:panelGrid  columns="2" columnClasses="label,value">


                            <h:outputText for="Lastname" value="Lastname" />
                            <p:inputText id="Lastname" value="#{userBean.userToSave.name}" required="true" />

                            <h:outputText for="Firstname" value="Firstname" />
                            <p:inputText id="Firstname" value="#{userBean.userToSave.firstName}"  required="true" />

                            <h:outputText for="Username" value="Username" />
                            <p:inputText id="Username" value="#{userBean.userToSave.userName}" required="true" />

                            <h:outputText for="Password" value="Password" />
                            <p:password id="Password" value="#{userBean.userToSave.password}" toggleMask="true" redisplay="true" feedback="true" required="true" />

                            <h:outputText for="Email" value="Email" />
                            <p:inputText id="Email" value="#{userBean.userToSave.email}" required="true" />

                            <h:outputText for="Active" value="Active" />
                            <p:selectBooleanCheckbox id="Active" value="#{userBean.userToSave.actif}" itemLabel="Activate"/>


                            <h:outputText for="Admin" value="Admin" />
                            <p:selectBooleanCheckbox id="Admin" value="#{userBean.userToSave.admin}" itemLabel="Administrator"/>


                        </p:panelGrid>
                        <p:commandButton value="Save" icon="fa fa-fw fa-pencil" action="#{userBean.register(true)}"/>
                    </p:outputPanel>
                </p:dialog>
            </h:form>

    </h:panelGrid>
</h:body>
</html>
