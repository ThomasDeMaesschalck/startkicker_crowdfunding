<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
				"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	  xmlns:h="http://xmlns.jcp.org/jsf/html"
	  xmlns:f="http://xmlns.jcp.org/jsf/core"
	  xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Startkicker - Home</title>
	<h:outputStylesheet name="css/primeflex.css" />
	<h:outputStylesheet library="css" name="style.css" />
</h:head>
<h:body>

	<div class="card">
		<h:form>
			<p:growl id="messages"/>

			<p:menubar>
				<f:facet name="options">
					<p:linkButton outcome="index" value="Home" style="margin-right:20px;" />
				</f:facet>


				<f:facet name="options">
					<p:linkButton rendered="#{loggedInUser != null}" outcome="createproject" value="Create a project" style="margin-right:20px;" />
					<p:button rendered="#{loggedInUser == null}" outcome="login" value="Login here" style="margin-right:20px;"  />
				</f:facet>

				<p:divider layout="vertical"/>


				<f:facet name="options">

					<p:linkButton  rendered="#{loggedInUser == null}" outcome="register" value="Register" style="margin-right:20px;" />

					<p:linkButton rendered="#{loggedInUser.admin == true}" outcome="admin" value="Admin" style="margin-right:20px;" />

					<p:commandButton  rendered="#{loggedInUser != null}" value="Logout"
												action="#{loginBean.logout}" style="margin-right:20px;"
									  icon="pi pi-fw pi-sign-out" styleClass="ui-button-info"></p:commandButton>
				</f:facet>
			</p:menubar>
		</h:form>
	</div>


	<h:form >
	</h:form>




	<br></br><br></br>


	<p:card>

		<h:panelGrid columns="2" rendered="#{loggedInUser != null}">
			<h:outputText value="Hello "></h:outputText>
		<h:outputText value="#{loggedInUser.firstName}"></h:outputText>
<br></br><br></br>
		</h:panelGrid>

	</p:card>

	<p:card>
	<h2>Project lists</h2>
		<h:form id="projectForm">
			<p:dataTable id="projectList" value = "#{myAppWideBean.allProjects}" var = "project"
						 rows="10"
						 paginator="true"
						 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
						 currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
						 rowsPerPageTemplate="5,10,{ShowAll|'All'}" >

				<p:column headerText="Id">
					<h:outputText value="#{project.id}" />
				</p:column>

				<p:column headerText="Title">
					<h:outputText value="#{project.title}" />
				</p:column>

				<p:column headerText="Start date">
					<h:outputText value="#{project.startDate}" />

				</p:column>
				<p:column headerText="Creator">
					<h:outputText value="#{project.creator.userName}" />
				</p:column>

				<p:column headerText="Status">
					<h:outputText value="#{project.status}" />
				</p:column>

				<p:column headerText="View">

					<p:commandButton value="View"  action="#{projectBean.view}"   style="margin-right:20px;" styleClass="ui-button-info">
						<f:setPropertyActionListener value="#{project}" target="#{projectBean.selectedProject}"/>
					</p:commandButton>


					<p:commandButton value="Edit" rendered="#{project.creator.id == loggedInUser.id}" icon="fa fa-edit" update=":projectForm:projectEdit" oncomplete="PF('projectEditDialog').show()">
						<f:setPropertyActionListener value="#{project}" target="#{projectBean.selectedProject}"/>
					</p:commandButton>

					<p:commandButton rendered="#{project.creator.id == loggedInUser.id}" action="#{projectBean.deleteProject(project)}" value="Delete"  update="projectList" />


				</p:column>

			</p:dataTable>



			<p:dialog header="Edit project" widgetVar="projectEditDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" responsive="true">
				<p:outputPanel id="projectEdit" style="text-align:center;">


					<p:panelGrid  columns="2" rendered="#{not empty projectBean.selectedProject}" columnClasses="label,value">

						<h:outputText value="id #{projectBean.selectedProject.id}" type="hidden"/>

						<p:inputNumber type="hidden" value="#{projectBean.selectedProject.id}"/>

						<h:outputText value="Title: " />
						<p:inputText value="#{projectBean.selectedProject.title}" />
						<h:outputText value="Description: " />
						<p:textEditor escape="false" secure="false" responsive="true" value="#{projectBean.selectedProject.description}" >
						<f:facet name="toolbar">
             <span class="ql-formats">
                <button class="ql-bold"></button>
                <button class="ql-italic"></button>
                <button class="ql-underline"></button>
                <button class="ql-strike"></button>
            </span>
						</f:facet>
					</p:textEditor>
						<h:outputText value="Funds required: " />
						<p:inputNumber value="#{projectBean.selectedProject.fundingTarget}" />
						<h:outputText value="Start date: " />
						<p:datePicker id="startDate" value="#{projectBean.selectedProject.startDate}" >
							<p:ajax event="dateSelect" update="endDate" global="false" />
							<p:ajax event="change" update="endDate" global="false" />
						</p:datePicker>
						<h:outputText value="End date:" />
						<p:datePicker id="endDate" mindate="#{projectBean.minEditEndDate}" value="#{projectBean.selectedProject.endDate}"/>

						<h:outputText value="Project created by:" />
						<h:outputText value="#{projectBean.selectedProject.creator.userName}"/>

						<h:outputText value="Comments: " rendered="#{projectBean.getEnumIntPosition(projectBean.selectedProject.status) >= 1}" />
						<p:inputText value="#{projectBean.selectedProject.comment}" rendered="#{projectBean.getEnumIntPosition(projectBean.selectedProject.status) >= 1}"/>
					</p:panelGrid>
					<p:commandButton value="Update" icon="fa fa-fw fa-pencil" action="#{projectBean.projectEdit}"/>

				</p:outputPanel>
			</p:dialog>

		</h:form>
	</p:card>

</h:body>
</html>
